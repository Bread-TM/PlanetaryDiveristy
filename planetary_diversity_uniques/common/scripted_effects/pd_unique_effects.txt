@resolution_flag_timer = 360

append_scrap_pile_build = {
	if = {
		limit = { is_variable_set = scrap_pile_build }
		change_variable = {
			which = scrap_pile_build
			value = 1
		}
		else = {
			set_variable = {
				which = scrap_pile_build
				value = 1
			}
		}
	}
}

remove_scrap_pile_build = {
	if = {
		limit = { is_variable_set = scrap_pile_build }
		subtract_variable = {
			which = scrap_pile_build
			value = 1
		}
		if = {
			limit = {
				check_variable = {
					which = scrap_pile_build
					value = 0
				}
			}
			clear_variable = scrap_pile_build
		}
	}
}

refresh_scrap_pile_build_modifier = {
	if = {
		limit = { has_modifier = holding_scrap_pile_build_modifier }
		remove_modifier = holding_scrap_pile_build_modifier
	}
	if = {
		limit = { is_variable_set = scrap_pile_build }
		add_modifier = {
			modifier = holding_scrap_pile_build_modifier
			multiplier = scrap_pile_build
		}
	}
}

pd_reset_ai_start = {
	set_origin = origin_default
	
	capital_scope = {
		set_planet_flag  gpm_has_planet_rings
		set_planet_size = 18
		random_list = {
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_tropical } }	change_pc = pc_tropical }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_arid } }		change_pc = pc_arid }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_continental } }	change_pc = pc_continental }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_ocean } }		change_pc = pc_ocean }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_tundra } }		change_pc = pc_tundra }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_arctic } }		change_pc = pc_arctic }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_alpine } }		change_pc = pc_alpine }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_savannah } }	change_pc = pc_savannah }
			1 = { every_owned_pop = { limit = { is_robot_pop = no is_sapient = yes } modify_species = { ideal_planet_class = pc_desert } }		change_pc = pc_desert }
		}
		generate_start_deposits_and_blockers = yes
		remove_all_buildings = yes
		generate_start_buildings_and_districts = yes
		
		solar_system = {

			spawn_planet = {
				class = rl_no_atmosphere_planets
				size = 12
				location = star
				orbit_angle_offset = 124
				orbit_distance_offset = 45
				orbit_location = yes
				init_effect = {
					set_name = pd_rename_planet_01
					set_planet_flag = gpm_has_planet_rings
				}
			}

			spawn_planet = {
				class = pc_gas_giant
				size = 30
				location = star
				orbit_angle_offset = 234
				orbit_distance_offset = 57
				orbit_location = yes
				has_ring = yes
				init_effect = {
					set_name = pd_rename_planet_02
				}
			}

			spawn_planet = {
				class = pc_toxic
				size = 16
				location = star
				orbit_angle_offset = 32
				orbit_distance_offset = 78
				orbit_location = yes
				init_effect = {
					set_name = pd_rename_planet_03
					set_planet_flag = gpm_has_planet_rings
				}
			}

			spawn_planet = {
				class = pc_gas_giant
				size = 20
				location = star
				orbit_angle_offset = 281
				orbit_distance_offset = 92
				orbit_location = yes
				has_ring = no
				init_effect = {
					set_name = pd_rename_planet_04
				}
			}

			spawn_planet = {
				class = rl_unhabitable_planets
				size = 21
				location = star
				orbit_angle_offset = 93
				orbit_distance_offset = 105
				orbit_location = yes
				init_effect = {
					set_name = pd_rename_planet_05
					set_planet_flag = gpm_has_planet_rings
				}
			}

			spawn_planet = {
				class = pc_gas_giant
				size = 18
				location = star
				orbit_angle_offset = 325
				orbit_distance_offset = 123
				orbit_location = yes
				has_ring = no
				init_effect = {
					set_name = pd_rename_planet_06
				}
			}

			spawn_planet = {
				class = rl_unhabitable_planets
				size = 24
				location = star
				orbit_angle_offset = 164
				orbit_distance_offset = 146
				orbit_location = yes
				init_effect = {
					set_name = pd_rename_planet_07
					set_planet_flag = gpm_has_planet_rings
				}
			}

			generate_home_system_resources = yes

			every_system_planet = {
				if = {
					limit = {
						has_deposit_for = shipclass_mining_station
						has_mining_station = no
					}
					create_mining_station = { owner = root }
				}
				else_if = {
					limit = {
						has_deposit_for = shipclass_research_station
						has_research_station = no
					}
					create_research_station = { owner = root }
				}
			}
		}
	}
}